<script type="text/javascript">
    RED.nodes.registerType('hue-bridge',{
        category: 'HueMagic',
        color: '#b7b7b7',
        defaults: {
            name: { value:"" },
            bridge: { type: "hue-bridge-config", required: true },
            autoupdates: { value: true },
            skipglobalevents: { value: false },
            initevents: { value: false }
        },
        align: 'left',
        icon: "hue-bridge.png",
        inputs: 1,
        outputs: 1,
        label: function() {
            return this.name || this._("hue-bridge.node.title");
        },
        paletteLabel: function() {
            return this._("hue-bridge.node.title");
        },
        inputLabels: function() {
            return this._("hue-bridge.node.input");
        },
        outputLabels: function() {
            return this._("hue-bridge.node.output");
        },
        button: {
            onclick: function()
            {
                const node = this;
                if(node.bridge)
                {
                    $.ajax({
                        url: "inject/" + node.id,
                        type: "POST",
                        data: JSON.stringify({ __user_inject_props__: "status"}),
                        contentType: "application/json; charset=utf-8",
                        success: function (resp) {
                            RED.notify(node.name + ": " + node._("hue-bridge.node.statusmsg"), { type: "success", id: "status", timeout: 2000 });
                        }
                    });
                }
            }
        }
    });
</script>